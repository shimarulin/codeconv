---
title: Модули (пакеты)
description: Создание и разработка модулей
position: 0
category: Обоснования
---

## Создание модуля

### Модуль в контексте монорепозитория

#### Концепция рабочих пространств

При разработке модулей внутри монорепозитория возникает вопрос, где их располагать в файловой структуре проекта и как
описывать их так, чтобы добавление пакета было возможно с минимумом усилий, а установка зависимостей происходила одной
командой. Yarn (а, начиная с версии 7, и NPM) предлагает использовать для этих целей
[`workspaces`](https://classic.yarnpkg.com/en/docs/workspaces/#toc-how-to-use-it). Из официальной документации следует,
что каждое из рабочих пространств может быть отдельным модулем:

<!-- prettier-ignore -->
```json
{
  "private": true,
  "workspaces": [
    "workspace-a", 
    "workspace-b"
  ]
}
```

workspace-a/package.json:

```json
{
  "name": "workspace-a",
  "version": "1.0.0",

  "dependencies": {
    "cross-env": "5.0.5"
  }
}
```

workspace-b/package.json:

```json
{
  "name": "workspace-b",
  "version": "1.0.0",

  "dependencies": {
    "cross-env": "5.0.5",
    "workspace-a": "1.0.0"
  }
}
```

В таком случае при добавлении любого пакета нам придется дополнительно указывать его в поле `workspaces`. Однако, можно
избежать этого дополнительного действия, если вместо определенного пути для модуля, указать при помощи паттерна каталог,
где эти модули размещаются:

<!-- prettier-ignore -->
```json
{
  "private": true,
  "workspaces": [
    "packages/*"
  ]
}
```

Теперь любой модуль в каталоге `packages` будет распознан корректно, а при добавлении нового модуля не необходимости
вносить дополнительные изменения в корневой файл `package.json`. Кроме того, выделение отдельного каталога под модули
упрощает их поиск в структуре проекта, а название каталога отлично отражает его содержимое.

#### Пространства имен публикуемых пакетов

[Пространства имен NPM](https://docs.npmjs.com/cli/v7/using-npm/scope) предназначены, чтобы указать принадлежность
пакета определенной организации или проекту. Зачастую в контексте монорепозитория модуль разрабатывается исключительно
для данного конкретного проекта, однако решение о том, использовать или нет пространства имен в каждом конкретном
случае, остается, конечно же, за разработчиками проекта.

В случае использования пространства имен при создании первого модуля возникает вопрос, откуда взять информацию о
конкретном имени и расположении пакетов, соответствующих данному пространству имен, в файловой структуре. Кроме того,
следует учитывать, что порой один монорепозиторий может содержать в себе несколько пространств имен. Обратившись к
концепции рабочих пространств, можно выделить под каждое пространство имен отдельное рабочее пространство:

<!-- prettier-ignore -->
```json
{
  "private": true,
  "workspaces": [
    "packages/@scope-a/*",
    "packages/@scope-b/*"
  ]
}
```

Имя каталога определенного пространства имен здесь должно полностью совпадать с именем пространства имен и начинаться с
символа `@`. Таким образом, при создании модуля у нас будет информация о том, какие пространства имен представлены в
монорепозитории и где их располагать в файловой структуре проекта. Группировка по пространствам имен также упрощает
поиск модулей в структуре проекта.

#### Группировка пакетов по функционалу

В достаточно крупном проекте иногда полезно дополнительно сгруппировать модули по их функциональному назначению или
типу. Например, можно сгруппировать приложения и библиотеки проекта. Развивая концепцию рабочих пространств, это может
выглядеть как:

<!-- prettier-ignore -->
```json
{
  "private": true,
  "workspaces": [
    "packages/@scope-a/apps/*", 
    "packages/@scope-a/libs/*", 
    "packages/@scope-b/*"
  ]
}
```

Таким образом, при создании модуля нужно выбрать не только пространство имен, но также еще и подкаталог типа модуля. Для
каждого проекта характерна своя специфика, поэтому наименование групп модулей может быть произвольным.
